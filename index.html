<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cctv main</title>
    <link rel="stylesheet" href="css/menu1.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="shortcut icon" href="./img/cctv.ico">
    <script
      src="https://code.jquery.com/jquery-3.5.1.js"
      integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
      crossorigin="anonymous"
    ></script>
   
    <script src="js/script.js"></script>
    <!-- <script src="js/weather.js"></script> -->
    <script
	src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=l7xxbcb5f54ae7ab45d4829fd9e0c8afd203"></script>
<script type="text/javascript">

//Tmap

var map; // 페이지가 로딩된 후에 호출하는 함수

// 1. 지도 띄우기
function initTmap(){
	map = new Tmapv2.Map("map_div", // "map_div" : 지도가 표시될 div의 id
	{
		center: new Tmapv2.LatLng(35.84320551361856 , 128.58782404494147), // 지도 초기 좌표
		width: "100%", // width설정
		height: "1000px", // height설정
		zoom: 0
	});


  // map.events.register("click", map, onClick);//map 클릭 이벤트를 등록합니다.
	// markerLayer = new Tmap.Layer.Markers();
	// map.addLayer(markerLayer);
			


  //Marker 객체 생성.
  var marker = new Tmapv2.Marker({
			position: new Tmapv2.LatLng(35.84320551361856 , 128.58782404494147), //Marker의 중심좌표 설정.
			map: map //Marker가 표시될 Map 설정..
		});


	var lonlat = new Tmap.LonLat(126.984895, 37.566369).transform("EPSG:4326", "EPSG:3857"); //테스트 좌표		
	var size = new Tmap.Size(28, 28);
	var offset = new Tmap.Pixel(-(size.w/2), -size.h); 
	var icon = new Tmap.Icon('/static/drivingHabit/images/map_now.png', size, offset);
			
	marker = new Tmap.Marker(lonlat, icon);
	markerLayer.addMarker(marker);		
	map.setCenter(new Tmap.LonLat(126.984895, 37.566369).transform("EPSG:4326", "EPSG:3857"), 15);
	map.removeZoomControl(); 
}



//지도를 클릭했을때 발생하는 이벤트 함수입니다.
function onClick(e){
	markerLayer.removeMarker(marker); // 기존 마커 삭제
	var lonlat = map.getLonLatFromViewPortPx(e.xy).transform("EPSG:3857", "EPSG:4326");//클릭 부분의 ViewPortPx를 LonLat 좌표로 변환합니다.
	console.log(lonlat);
	var size = new Tmap.Size(44, 44);//아이콘 사이즈 설정
	var offset = new Tmap.Pixel(-(size.w/2), -size.h);//아이콘 중심점 설정
	var icon = new Tmap.Icon('/static/drivingHabit/images/map_modify_big.png', size, offset);//마커 아이콘 설정
	marker = new Tmap.Marker(lonlat.transform("EPSG:4326", "EPSG:3857"), icon);//마커 생성
	markerLayer.addMarker(marker);//마커 레이어에 마커 추가
}


// 2. 시작, 도착 심볼찍기
	// 시작
	addMarker("Start",35.84820370878297, 128.58208787431428);
	// 도착 
	addMarker("End",126.6300998,37.3738325,2);
	function addMarker(status, lon, lat, tag) {
	//출도착경유구분


	//이미지 파일 변경.
	var markerLayer;
	switch (status) {
		case "Start":
			imgURL = 'http://tmapapis.sktelecom.com/upload/tmap/marker/pin_r_m_s.png';
			break;
		case "Pass":
			imgURL = 'http://tmapapis.sktelecom.com/upload/tmap/marker/pin_b_m_p.png';
			break;
		case "End":
			imgURL = 'http://tmapapis.sktelecom.com/upload/tmap/marker/pin_r_m_e.png';
			break;
		default:
	};
	var marker = new Tmapv2.Marker({
		position: new Tmapv2.LatLng(lat,lon),
		icon: imgURL,
		map: map
	});
	// 마커 드래그 설정
	marker.tag = tag;
	marker.addListener("dragend", function (evt) {
	markerListenerEvent(evt);
});
marker.addListener("drag", function (evt) {    	
	markerObject = markerList[tag];
});
markerList[tag] = marker;
	return marker;
	}

</script>
  </head>
  <body onload="initTmap()">
    <div id="map_div" ></div>
    <div class="container">
      <div id="sidebar">
        <div class="toggle-btn" onclick="toggleSidebar(this)">
          <i class="fa-solid fa-bars" id="bars"></i>
        </div>
        <div class="showbtn">
          <img
            src="img/close.png"
            id="triangle_close"
            onclick="toggleSidebar(this)"
          />
          <img
            src="img/open.png"
            id="triangle_open"
            onclick="toggleSidebar(this)"
          />
        </div>
        <div class="list" id="first-menu">
          <img src="img/daegu.png" alt="" id="logo" />
          <div class="menu">
            <p>CCTV를 경유하는 경로안내 서비스</p>
              <button class="button" id="menu1" onClick="location.href='index.html'">경로안내</button>
              <button class="button" id="menu2" onClick="location.href='search_around.html'">주변탐색</button>
          </div>
          <div class="location">
            <div class="navigation">
              <i class="fa-solid fa-flag"></i>
              <input
                type="text"
                placeholder="출발지를 입력하세요"
                id="location-start"
                class="input_text"
              />
              <button>✖</button>
            </div>
            <div class="navigation">
              <i class="fa-solid fa-flag-checkered"></i>
              <input
                type="text"
                placeholder="도착지를 입력하세요"
                id="location"
                class="input_text"
              />
              <button>✖</button>
            </div>
            <button class="showload">
              <i class="fa-solid fa-person-walking" id="direction"></i>
            </button>
          </div>
        </div>
        <div class="footer_info">
          <strong class="title_intro">
            오늘은
            <br />
            어디로 안내할까요?
          </strong>
          <p class="content_info">
            공공데이터를 이용해 CCTV의 위치를 확인하여
            <br />
            CCTV를 경유하는 최단 경로를 알려드려요.
          </p>
        </div>
        <div class="footer_img">
          <img src="img/footer_img.jpg">
        </div>
      </div>
    </div>
  
  </body>
</html>
